<div class="container">
	<% if flash[:notice] %>
	<p class="notice"><%= flash[:notice] %></p>
	<% end %>
	<%= render 'devise/shared/show', user: current_user, book: Book.new %>
	<% if @book.errors.any? %>
	<div class="error_explanation">
		<h2><%= pluralize(@book.errors.count, "error") %> prohibited this book from being saved:</h2>
		<ul>
			<% @book.errors.full_messages.each do |message| %>
			<li><%= message %></li>
			<% end %>
		</ul>
	</div>
	<% end %>



	<div class="col-xs-9">
		<h2>Book detail</h2>
		<table class="table">
			<tbody>
				<tr>
					<td>
						<%= link_to user_path(@user) do %>
						<%= attachment_image_tag @book.user, :profile_image, :fill, 100, 100, fallback: "no_image.jpg",size:'40x40' %><br />
						<%= @user.name %>
					</td>
					<td>
						<%= link_to @book.title, book_path(@book) %>
					</td>
					<td>
						<%= @book.body %>
						<% end %>
					</td>
						<%= render 'books/favorites', book: @book %>
					<% if @user.id == current_user.id %>
					<td>
						<%= link_to "Edit", edit_book_path(@book), class:"btn-sm btn-success" %>
					</td>
					<td>
						<%= link_to "Destroy", book_path(@book), method: :delete, data: {confirm: "本当に消しますか？"} ,class:"btn-sm btn-danger" %>
					</td>
					<td>コメント件数: <%= @book.book_comments.count %> </td>

					<% end %>
				</tr>
			</tbody>
		</table>
		
		<%= render 'book_comments/index', book_comments: @book_comments%>
		<div class="col-xs-6">
			<div class="comment-form">
				<%= form_with(model: [@book, @book_comment]) do |f| %>
						<%= f.text_area :content, size: "95x5" %>
						<%= f.submit "送信", class: "btn-sm btn-primary" %>
				<% end %>
		</div>
	</div>
</div>

